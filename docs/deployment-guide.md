# Deployment Guide

This guide provides step-by-step instructions to deploy Forgejo on Render.com.

## Step 1: Repository Setup
1. Create a new repository on GitHub (or other Git hosting service).
2. Upload all the files from the `forgejo-render-deployment` package to this new repository.
3. Commit and push the changes to your repository.

## Step 2: Render.com Configuration
1. Log in to your Render.com account.
2. Connect your GitHub account to Render.com if you haven't already.
3. Click on "New Web Service" from your Render dashboard.
4. Select the repository you created in Step 1.
5. Render will automatically detect the `render.yaml` file and pre-fill most of the settings. Verify the following:
   - **Service Type**: Web Service
   - **Name**: `forgejo-git-service` (or your preferred name)
   - **Environment**: Docker
   - **Build Command**: `docker build . -t forgejo-app`
   - **Start Command**: `/usr/local/bin/setup.sh`
   - **Port**: `3000`
   - **Health Check Path**: `/`
   - **Region**: Choose a region close to your users.
   - **Plan**: `Starter` (or higher, depending on your needs).

## Step 3: Database Setup
1. In your Render dashboard, create a new PostgreSQL database.
2. Name the database `forgejo-db` (or your preferred name) and the database name `forgejo` with user `forgejo`.
3. Note down the connection details (Host, Database, User, Password) provided by Render.com. These will be used for environment variables.

## Step 4: Configure Environment Variables
1. In your Forgejo web service settings on Render.com, navigate to the "Environment" section.
2. Add the following environment variables. Some will be automatically generated by Render.com from `render.yaml` (like `ROOT_URL`, `SSH_DOMAIN`, `SECRET_KEY`, `INTERNAL_TOKEN`, `JWT_SECRET`), but you need to manually add the database credentials and optionally the admin user details.

   ```
   # Database Configuration (from your Render.com PostgreSQL database)
   DB_HOST=<your-render-db-host>
   DB_NAME=forgejo
   DB_USER=forgejo
   DB_PASSWD=<your-render-db-password>

   # Optional: Initial Admin User (set these to create an admin user on first run)
   ADMIN_USERNAME=admin
   ADMIN_PASSWORD=your-secure-admin-password
   ADMIN_EMAIL=admin@example.com
   ```
   **Important**: Replace `<your-render-db-host>` and `<your-render-db-password>` with the actual values from your Render.com database.
   For security, use strong, randomly generated values for `SECRET_KEY`, `INTERNAL_TOKEN`, and `JWT_SECRET` if Render.com doesn't generate them automatically or if you want to override them.

## Step 5: Deploy
1. Once all configurations are set, click "Deploy" on your web service page.
2. Monitor the deployment logs to ensure there are no errors. The initial deployment might take some time as it builds the Docker image and sets up Forgejo.
3. After successful deployment, access your new Forgejo instance via the `ROOT_URL` provided by Render.com.

Congratulations! Your Forgejo instance should now be running on Render.com.

